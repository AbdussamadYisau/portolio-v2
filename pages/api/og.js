import { ImageResponse } from '@vercel/og';
import { NextRequest } from "next/server";

export const config = {
	runtime: 'edge',
};

// const fontNormal = fetch(new URL("../../assets/Inter-Medium.ttf", import.meta.url)).then((res) => res.arrayBuffer());
// const fontBold = fetch(new URL("../../assets/Inter-Black.ttf", import.meta.url)).then((res) => res.arrayBuffer());

export default async function (req) {
	try{
		// const fontData = await fontNormal;
		// const fontBoldData = await fontBold;
		const { searchParams } = req.nextUrl;
	
		const titlePost = searchParams.get('title');
		const subtitlePost = searchParams.get('subtitle');

	
		return new ImageResponse(
			(
				<div
					style={{
						display: 'flex',
						height: '100%',
						width: '100%',
						alignItems: 'center',
						justifyContent: 'space-between',
						flexDirection: 'row',
						backgroundImage: 'linear-gradient(left right, #D7694A, #9616D1)',
						fontSize: 60,
						letterSpacing: -2,
						fontWeight: 700,
						padding: '0px 40px'
					}}
				>
					<div
						style={{
							display: 'flex',
							fontSize: 40,
							fontStyle: 'normal',
							color: 'black',
							marginTop: 30,
							lineHeight: 1.8,
							flexDirection: 'column',
							whiteSpace: 'pre-wrap',
						}}
					>
						<div
							style={{
								display: 'flex',
								flexDirection: 'row',
								alignItems: 'center',
								justifyContent: 'center',
							}}
						>
							<svg width="381" height="77" viewBox="0 0 1528 310" fill="none" xmlns="http://www.w3.org/2000/svg">
								<path d="M1015.66 0.375H1281.78V49.6689H1176.21V308.998H1123.42V49.6689H1015.66V0.375Z" fill="#F6F6FD" />
								<path d="M577.986 0.375V49.6689H364.672V128.968H536.219V178.262H364.672V259.704H577.986V308.998H311.887V49.6689H311.865V0.375H577.986Z" fill="#F6F6FD" />
								<path d="M710.868 0.503906H641.79L889.214 309.127H958.493L834.766 154.921L958.296 0.739366L889.214 0.8465L800.181 111.816L710.868 0.503906Z" fill="#F6F6FD" />
								<path d="M781.754 220.954L747.161 177.789L641.593 309.361H710.869L781.754 220.954Z" fill="#F5F6FD" />
								<path fill-rule="evenodd" clip-rule="evenodd" d="M313.737 308.998L65.9802 0.246094H0V308.869H52.7843V66.214L247.426 308.998H313.737Z" fill="#F6F6FD" />
								<path d="M1293.64 307.114C1289.78 307.114 1286.49 305.77 1283.74 303.082C1280.98 300.394 1279.62 297.14 1279.66 293.285C1279.62 289.536 1280.98 286.318 1283.74 283.63C1286.49 280.942 1289.78 279.598 1293.64 279.598C1297.36 279.598 1300.62 280.942 1303.37 283.63C1306.16 286.318 1307.55 289.536 1307.59 293.285C1307.55 295.832 1306.91 298.166 1305.62 300.252C1304.3 302.375 1302.62 304.037 1300.51 305.24C1298.43 306.478 1296.14 307.114 1293.64 307.114Z" fill="#F6F6FD" />
								<path d="M1383.74 177.098H1407.13V267.534C1407.09 275.846 1405.3 282.955 1401.8 288.933C1398.26 294.91 1393.36 299.472 1387.06 302.69C1380.8 305.873 1373.47 307.501 1365.14 307.501C1357.52 307.501 1350.69 306.121 1344.61 303.433C1338.53 300.745 1333.7 296.713 1330.16 291.408C1326.58 286.103 1324.83 279.489 1324.83 271.567H1348.26C1348.29 275.033 1349.08 278.039 1350.58 280.55C1352.08 283.061 1354.16 284.971 1356.8 286.315C1359.48 287.659 1362.56 288.331 1366.03 288.331C1369.79 288.331 1373.01 287.553 1375.62 285.961C1378.22 284.405 1380.23 282.071 1381.63 278.958C1382.98 275.881 1383.7 272.062 1383.74 267.534V177.098Z" fill="#F6F6FD" />
								<path d="M1503.37 212.466C1502.8 206.984 1500.29 202.705 1495.93 199.663C1491.53 196.586 1485.84 195.065 1478.87 195.065C1473.97 195.065 1469.75 195.808 1466.25 197.258C1462.74 198.744 1460.02 200.724 1458.16 203.235C1456.3 205.747 1455.37 208.611 1455.3 211.83C1455.3 214.518 1455.94 216.852 1457.2 218.798C1458.45 220.778 1460.13 222.44 1462.31 223.785C1464.45 225.164 1466.85 226.295 1469.46 227.215C1472.11 228.135 1474.76 228.913 1477.4 229.55L1489.6 232.556C1494.5 233.687 1499.26 235.209 1503.8 237.154C1508.34 239.064 1512.45 241.504 1516.06 244.439C1519.68 247.375 1522.54 250.912 1524.65 255.05C1526.76 259.188 1527.83 264.033 1527.83 269.622C1527.83 277.155 1525.9 283.769 1522 289.498C1518.1 295.193 1512.49 299.649 1505.12 302.868C1497.79 306.051 1488.92 307.678 1478.48 307.678C1468.39 307.678 1459.59 306.122 1452.19 303.01C1444.75 299.932 1438.95 295.405 1434.77 289.463C1430.59 283.521 1428.33 276.271 1428.01 267.747H1451.19C1451.51 272.203 1452.94 275.917 1455.37 278.924C1457.84 281.894 1461.06 284.087 1464.99 285.573C1468.96 287.023 1473.4 287.766 1478.3 287.766C1483.41 287.766 1487.92 286.987 1491.82 285.466C1495.68 283.946 1498.72 281.824 1500.9 279.065C1503.12 276.342 1504.23 273.123 1504.26 269.445C1504.23 266.085 1503.22 263.29 1501.29 261.098C1499.33 258.905 1496.61 257.066 1493.14 255.581C1489.64 254.095 1485.56 252.751 1480.91 251.584L1466.1 247.835C1455.41 245.111 1446.93 240.974 1440.74 235.421C1434.52 229.868 1431.44 222.511 1431.44 213.28C1431.44 205.712 1433.52 199.062 1437.71 193.368C1441.85 187.674 1447.54 183.253 1454.73 180.105C1461.95 176.922 1470.11 175.365 1479.19 175.365C1488.42 175.365 1496.5 176.922 1503.48 180.105C1510.45 183.253 1515.92 187.638 1519.89 193.226C1523.86 198.815 1525.94 205.216 1526.05 212.466H1503.37Z" fill="#F6F6FD" />
							</svg>
	
						</div>
						<h1 tw="flex flex-col text-3xl font-black tracking-wide text-left bg-yellow-400 text-9xl py-4 px-6 uppercase rounded-3xl">{titlePost}</h1>
						<span tw="flex flex-col text-6xl font-medium tracking-tight text-left text-white">{subtitlePost}</span>
					</div>
					<div
						style={{
							display: 'flex',
							flexDirection: 'column',
							alignItems: 'center',
							justifyContent: 'center',
						}}
					>
						<svg width="137" height="434" viewBox="0 0 596 1882" fill="none" xmlns="http://www.w3.org/2000/svg">
					<circle cx="298.183" cy="298.487" r="277.814" transform="rotate(-4.27675 298.183 298.487)" fill="white"/>
					<g clip-path="url(#clip0_1542_62)">
					<path d="M282.885 58.1024C281.848 58.1966 278.55 58.5263 275.582 58.7619C207.122 64.9332 142.997 101.867 102.382 158.634C79.7665 190.197 65.3018 226 59.8363 263.923C57.9045 277.161 57.6689 281.071 57.6689 299.02C57.6689 316.969 57.9045 320.879 59.8363 334.116C72.9346 424.614 137.343 500.648 224.696 528.82C240.339 533.86 256.83 537.299 275.582 539.372C282.885 540.173 314.453 540.173 321.756 539.372C354.125 535.792 381.547 527.783 408.591 513.98C412.738 511.86 413.539 511.295 412.973 510.824C412.596 510.541 394.928 486.845 373.725 458.203L335.184 406.147L286.89 334.682C260.316 295.392 238.454 263.264 238.266 263.264C238.077 263.217 237.889 294.968 237.795 333.739C237.653 401.624 237.606 404.356 236.758 405.958C235.533 408.267 234.591 409.209 232.612 410.245C231.104 410.999 229.785 411.14 222.67 411.14H214.519L212.352 409.774C210.938 408.879 209.902 407.701 209.195 406.335L208.206 404.215L208.3 309.761L208.441 215.259L209.902 213.422C210.656 212.433 212.258 211.161 213.388 210.548C215.32 209.606 216.074 209.512 224.225 209.512C233.837 209.512 235.439 209.889 237.936 212.621C238.643 213.375 264.792 252.758 296.078 300.198C327.363 347.637 370.144 412.412 391.158 444.211L429.323 502.014L431.254 500.742C448.357 489.624 466.45 473.796 480.774 457.307C511.258 422.305 530.905 379.624 537.502 334.116C539.433 320.879 539.669 316.969 539.669 299.02C539.669 281.071 539.433 277.161 537.502 263.923C524.403 173.426 459.995 97.3916 372.642 69.2202C357.235 64.2266 340.838 60.7876 322.463 58.7148C317.94 58.2437 286.796 57.7255 282.885 58.1024ZM381.547 203.859C383.808 204.989 385.646 207.157 386.305 209.418C386.682 210.643 386.776 236.835 386.682 295.864L386.541 380.566L371.605 357.671L356.622 334.776V273.204C356.622 233.396 356.81 211.019 357.093 209.936C357.847 207.298 359.496 205.225 361.758 204C363.689 203.011 364.396 202.917 371.793 202.917C378.767 202.917 379.992 203.011 381.547 203.859Z" fill="black"/>
					</g>
					<circle cx="298.183" cy="1583.46" r="277.814" transform="rotate(-4.27675 298.183 1583.46)" fill="white"/>
					<g clip-path="url(#clip1_1542_62)">
					<path d="M298.184 1461.46C244.05 1461.46 210.217 1488.5 196.684 1542.58C216.984 1515.54 240.667 1505.4 267.734 1512.16C283.177 1516.02 294.215 1527.21 306.432 1539.6C326.335 1559.78 349.37 1583.14 399.684 1583.14C453.817 1583.14 487.65 1556.1 501.184 1502.02C480.884 1529.06 457.2 1539.2 430.134 1532.44C414.691 1528.59 403.653 1517.39 391.435 1505C371.532 1484.82 348.497 1461.46 298.184 1461.46ZM196.684 1583.14C142.55 1583.14 108.717 1610.18 95.1836 1664.27C115.484 1637.23 139.167 1627.09 166.234 1633.85C181.677 1637.7 192.715 1648.89 204.932 1661.28C224.835 1681.47 247.87 1704.83 298.184 1704.83C352.317 1704.83 386.15 1677.79 399.684 1623.71C379.384 1650.75 355.7 1660.89 328.634 1654.13C313.191 1650.27 302.153 1639.08 289.935 1626.69C270.032 1606.5 246.997 1583.14 196.684 1583.14Z" fill="url(#paint0_linear_1542_62)"/>
					</g>
					<circle cx="298.183" cy="940.971" r="256.645" fill="white" stroke="white" stroke-width="36"/>
					<path d="M70.6641 940.971V948.976C70.6641 1070.48 169.161 1168.98 290.664 1168.98H298.669H306.674C428.177 1168.98 526.674 1070.48 526.674 948.976V940.971V932.966C526.674 811.464 428.177 712.966 306.674 712.966H298.669H290.664C169.161 712.966 70.6641 811.464 70.6641 932.966V940.971Z" fill="#007ACC"/>
					<path d="M170.505 873.26L170.389 888.255H194.216H218.044V955.96V1023.67H234.898H251.752V955.96V888.255H275.579H299.407V873.551C299.407 865.415 299.233 858.615 299 858.441C298.826 858.208 269.826 858.092 234.665 858.15L170.679 858.324L170.505 873.26Z" fill="white"/>
					<path d="M384.972 857.901C394.271 860.226 401.361 864.352 407.87 871.093C411.241 874.697 416.239 881.264 416.646 882.833C416.762 883.298 400.838 893.991 391.19 899.977C390.842 900.21 389.447 898.699 387.878 896.374C383.17 889.516 378.23 886.552 370.675 886.029C359.575 885.274 352.427 891.086 352.485 900.791C352.485 903.639 352.892 905.324 354.054 907.649C356.495 912.705 361.028 915.727 375.267 921.887C401.477 933.162 412.694 940.601 419.668 951.178C427.455 962.976 429.199 981.805 423.91 995.812C418.098 1011.04 403.686 1021.38 383.403 1024.81C377.126 1025.92 362.248 1025.74 355.507 1024.52C340.803 1021.91 326.855 1014.64 318.254 1005.11C314.883 1001.39 308.316 991.685 308.723 990.988C308.897 990.755 310.409 989.826 312.094 988.838C313.721 987.908 319.882 984.363 325.693 980.992L336.212 974.89L338.421 978.144C341.501 982.852 348.242 989.303 352.311 991.453C363.992 997.613 380.032 996.741 387.936 989.651C391.307 986.571 392.702 983.375 392.702 978.667C392.702 974.425 392.178 972.565 389.97 969.369C387.122 965.3 381.311 961.872 364.806 954.723C345.918 946.587 337.781 941.531 330.342 933.511C326.042 928.861 321.974 921.422 320.288 915.204C318.894 910.032 318.545 897.072 319.649 891.841C323.543 873.592 337.316 860.865 357.192 857.087C363.643 855.867 378.637 856.332 384.972 857.901Z" fill="white"/>
					<defs>
					<linearGradient id="paint0_linear_1542_62" x1="83.9058" y1="1539.34" x2="434.385" y2="1741.61" gradientUnits="userSpaceOnUse">
					<stop stop-color="#2298BD"/>
					<stop offset="1" stop-color="#0ED7B5"/>
					</linearGradient>
					<clipPath id="clip0_1542_62">
					<rect width="482" height="482" fill="white" transform="translate(57.6689 57.9727)"/>
					</clipPath>
					<clipPath id="clip1_1542_62">
					<rect width="406" height="244" fill="white" transform="translate(95.1836 1461.46)"/>
					</clipPath>
					</defs>
					</svg>
					</div>
				</div>
			),
			{
				width: 1200,
				height: 600,
				
			},
		);
	} catch (e){
    return new Response(`Failed to generate the OG image. Error ${e.message}`, {
      status: 500,
    });
	}
}